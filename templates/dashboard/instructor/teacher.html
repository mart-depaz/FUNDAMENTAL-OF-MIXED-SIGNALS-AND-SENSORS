<!--
templates folder: library_system/templates/dashboard/teacher.html
-->

{% extends 'partials/base.html' %}
{% load dashboard_filters %}
{% load static %}
{% block title %}Teacher Dashboard{% endblock %}
{% block navigation %}
<!-- Override default navigation - no top bar for teacher -->
{% endblock %}
{% block content %}
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
<link rel="stylesheet" href="{% static 'css/mobile_responsive.css' %}">
<style>
    body { 
        font-family: 'Inter', sans-serif; 
        background: #f4f5fb;
    }
    
    /* Mobile sidebar hamburger menu */
    @media (max-width: 1024px) {
        .sidebar-mobile-toggle {
            display: flex !important;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            background: linear-gradient(90deg, #ffffff 0%, #f3e5f5 100%);
            border: none;
            cursor: pointer;
            font-size: 20px;
            color: #7b1fa2;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            z-index: 1001;
        }
        
        .sidebar-mobile-toggle:hover {
            background: #e1bee7;
            transform: scale(1.05);
        }
        
        .sidebar-mobile-toggle.open {
            background: #e1bee7;
        }
    }
    
    @media (max-width: 768px) {
        .sidebar-mobile-toggle {
            display: flex !important;
        }
        
        /* Position sidebar toggle in topbar */
        #teacher-topbar {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
        }
        
        .topbar-title {
            flex: 1;
            font-size: 1.1rem;
        }
    }
</style>

<!-- Mobile tweaks: reduce spacing, font sizes and card padding for small phones (e.g. 412x892) -->
<style>
    @media (max-width: 412px) {
        /* Main content padding */
        #main-content { padding: 8px !important; margin-top: 56px !important; }

        /* Hero adjustments */
        .bg-gradient-to-r.rounded-3xl { padding: 12px !important; border-radius: 12px !important; }
        .bg-gradient-to-r.rounded-3xl h1 { font-size: 1rem !important; line-height: 1.1 !important; }
        .bg-gradient-to-r.rounded-3xl p { font-size: 12px !important; }

        /* Avatar */
        .w-24.h-24 { width:48px !important; height:48px !important; }
        .w-24.h-24 img { width:48px !important; height:48px !important; }

        /* Stat cards: stack into single column and reduce padding */
        .grid.grid-cols-1.md\:grid-cols-2.xl\:grid-cols-4 { grid-template-columns: 1fr !important; gap:8px !important; }
        .rounded-2xl.p-5 { padding: 10px !important; border-radius: 12px !important; }
        .rounded-2xl.p-5 .w-12.h-12 { width:44px !important; height:44px !important; }
        .rounded-2xl.p-5 p.text-2xl { font-size: 1.25rem !important; }

        /* Cards and sections general */
        .rounded-3xl, .rounded-2xl { padding: 10px !important; }
        section { padding: 10px !important; }

        /* Buttons */
        a.inline-flex.items-center.gap-2, .p-4.rounded-2xl, button { padding: 8px 10px !important; font-size: 13px !important; }
        .inline-flex.items-center.gap-2 i { font-size: 14px !important; }

        /* Reduce headings everywhere to fit */
        .text-xl { font-size: 1rem !important; }
        .text-2xl { font-size: 1.05rem !important; }

        /* Make grids single-column where space is tight */
        .grid.grid-cols-1.md\:grid-cols-2.xl\:grid-cols-3 { grid-template-columns: 1fr !important; }

        /* Quick actions grid spacing */
        .grid.grid-cols-1.sm\:grid-cols-2.lg\:grid-cols-4 { grid-template-columns: repeat(2, 1fr) !important; gap:8px !important; }

        /* Topbar adjustments */
        #teacher-topbar, #teacher-top-bar { padding: 8px !important; }
        .mobile-sidebar-toggle, #mobile-sidebar-toggle { width:44px !important; height:44px !important; left:8px !important; top:8px !important; }
    }

    /* Force full-width layout and responsive elements to prevent collapsing */
    @media (max-width: 1024px) {
        /* make sure all container boxes use full width */
        .min-h-screen, .flex-grow, main, #main-content, .p-4, .p-6, .p-8 {
            box-sizing: border-box !important;
            width: 100% !important;
            max-width: 100% !important;
            margin-left: 0 !important;
            margin-right: 0 !important;
            padding-left: 8px !important;
            padding-right: 8px !important;
        }

        /* ensure cards don't overflow and scale their contents */
        .rounded-2xl, .rounded-3xl, .shadow-inner, .shadow, .shadow-xl {
            max-width: 100% !important;
            width: 100% !important;
        }

        /* images and avatars scale down */
        img, .object-cover, .w-full { max-width: 100% !important; height: auto !important; }

        /* prevent long text from overflowing */
        .truncate, .text-2xl, .text-xl, p, h1, h2, h3 {
            word-break: break-word !important;
            overflow-wrap: anywhere !important;
        }

        /* ensure grid columns collapse to single column when needed */
        .grid, .grid-cols-1, .md\:grid-cols-2, .xl\:grid-cols-3, .xl\:grid-cols-4 {
            grid-template-columns: 1fr !important;
        }

        /* reduce interactive element sizes and ensure touch targets remain usable */
        a, button { min-height: 36px !important; padding: 8px 10px !important; font-size: 13px !important; }
    }

    /* Fix overlapping cards: ensure grid children and flex items can shrink and wrap on small screens */
    @media (max-width: 768px) {
        /* Make grid children occupy full width and prevent overflow */
        .grid > div, .grid > a, .grid > section {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
            min-width: 0 !important; /* allow flex items to shrink */
        }

        /* Ensure headers and inline flex rows wrap instead of overflowing */
        .flex.items-center.justify-between, .flex.items-center, .flex.flex-col.lg\:flex-row {
            flex-wrap: wrap !important;
            gap: 6px !important;
        }

        /* Allow truncation for long text and titles */
        h1, h2, h3, p, .truncate {
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            white-space: normal !important;
            word-break: break-word !important;
        }

        /* Specific card adjustments to avoid overlap */
        .rounded-3xl, .rounded-2xl { padding: 12px !important; }
        .rounded-3xl .flex > div, .rounded-2xl .flex > div { min-width: 0 !important; }
    }

    /* Slightly larger phones / small tablets */
    @media (min-width: 413px) and (max-width: 768px) {
        #main-content { padding: 12px !important; }
        .bg-gradient-to-r.rounded-3xl { padding: 16px !important; }
        .rounded-2xl.p-5 { padding: 12px !important; }
    }
</style>

<!-- Notification System removed (notifications feature deprecated). Showing System Center placeholder. -->
<style>
    .system-status-dot { width:10px; height:10px; border-radius:50%; display:inline-block; margin-right:6px; }
    .system-status-ok { background:#10B981; }
    .system-status-down { background:#EF4444; }
</style>

<!-- Teacher Top Bar -->
{% include 'dashboard/instructor/teacher_topbar.html' %}

<div class="min-h-screen bg-gray-100 flex flex-col lg:flex-row">
    <!-- Sidebar -->
    {% include 'dashboard/instructor/teacher_sidebar.html' %}

    <!-- Main Content -->
    <main id="main-content" class="flex-grow p-4 lg:p-6 lg:ml-64 mt-16 overflow-y-auto" style="height: calc(100vh - 64px); overscroll-behavior: contain;">
        <div class="p-4 md:p-8 bg-white lg:bg-gray-50 flex-grow rounded-2xl shadow-inner min-h-full">
            {% block dashboard_content %}
            <div class="space-y-6">
                <!-- Hero -->
                <section class="bg-gradient-to-r from-rose-400 via-orange-300 to-sky-400 rounded-3xl text-white p-6 md:p-8 shadow-2xl relative overflow-hidden">
                    <div class="absolute inset-0 bg-white/10 blur-3xl"></div>
                    <div class="relative z-10 flex flex-col gap-6">
                        <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
                            <div class="flex items-center gap-5">
                                <div class="w-24 h-24 rounded-full bg-white/20 border-2 border-white/60 overflow-hidden flex items-center justify-center text-3xl font-semibold uppercase shadow-xl">
                                    {% if user.profile_picture %}
                                        <img src="{{ user.profile_picture.url }}" alt="{{ user.full_name|default:user.username }}" class="w-full h-full object-cover">
                                    {% else %}
                                        <span>{{ user.full_name|default:user.username|first|upper }}</span>
                                    {% endif %}
                                </div>
                                <div class="flex flex-col">
                                    <p class="uppercase text-xs tracking-[0.35em] text-white/70 font-semibold mb-1">Instructor Dashboard</p>
                                    <h1 class="text-xl md:text-2xl font-extrabold truncate max-w-full lg:max-w-2xl" title="{{ user.full_name|default:user.username }}">
                                        Hello, {{ user.full_name|default:user.username }}
                                </h1>
                                    <p class="text-white/90 mt-2 text-sm md:text-base max-w-2xl">
                                    Everything you need for today's classes lives here—course statuses, upcoming schedules, student engagement, and quick actions.
                                </p>
                                </div>
                            </div>
                            <div class="rounded-2xl px-6 py-4 backdrop-blur-md border border-white/10 shadow-lg text-sm text-white" style="background: linear-gradient(135deg, #1a1b1f 0%, #341428 35%, #55104b 65%, #7a2d68 100%);">
                                <p class="font-semibold text-white/80 uppercase tracking-wide text-xs">Daily Outlook</p>
                                <div class="flex items-center gap-6 mt-2 text-white">
                                    <div>
                                        <p class="text-3xl font-bold">{{ total_courses|default:0 }}</p>
                                        <p class="text-xs uppercase tracking-wide text-white/70">Active Courses</p>
                                    </div>
                                    <div>
                                        <p class="text-3xl font-bold">{{ active_students|default:0 }}</p>
                                        <p class="text-xs uppercase tracking-wide text-white/70">Students Reached</p>
                                    </div>
                                    <div>
                                        <p class="text-3xl font-bold">{% if attendance_reports_count %}{{ attendance_reports_count }}{% elif reports_count %}{{ reports_count }}{% elif attendance_count %}{{ attendance_count }}{% else %}0{% endif %}</p>
                                        <p class="text-xs uppercase tracking-wide text-white/70">Attendance Reports</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-wrap gap-3">
                            <a href="{% url 'dashboard:instructor_courses' %}" class="inline-flex items-center gap-2 bg-white/20 hover:bg-white/30 transition px-4 py-2 rounded-xl text-sm font-semibold">
                                <i class="fas fa-layer-group text-white"></i> Manage Courses
                            </a>
                            <a href="{% url 'dashboard:weekly_timetable' %}" class="inline-flex items-center gap-2 bg-white text-indigo-600 hover:bg-gray-100 transition px-4 py-2 rounded-xl text-sm font-semibold shadow">
                                <i class="fas fa-calendar-week"></i> Timetable
                            </a>
                            <a href="{% url 'dashboard:students' %}" class="inline-flex items-center gap-2 bg-white/20 hover:bg-white/30 transition px-4 py-2 rounded-xl text-sm font-semibold">
                                <i class="fas fa-user-graduate text-white"></i> Students
                            </a>
                        </div>
                    </div>
                </section>

                <!-- Stat Cards -->
                <section class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4">
                    <div class="rounded-2xl p-5 flex items-center gap-4 border border-transparent shadow" style="background: linear-gradient(135deg, #6281DC 0%, #9F80E8 100%);">
                        <div class="w-12 h-12 rounded-full bg-white/30 text-white flex items-center justify-center text-xl shadow inner-shadow">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="text-white">
                            <p class="text-xs uppercase tracking-wide font-semibold opacity-80">Courses</p>
                            <p class="text-2xl font-bold">{{ total_courses|default:0 }}</p>
                            <p class="text-xs opacity-80">Active & published</p>
                        </div>
                    </div>
                    <div class="rounded-2xl p-5 flex items-center gap-4 border border-transparent shadow" style="background: linear-gradient(135deg, #42B2CB 0%, #7DC9DD 100%);">
                        <div class="w-12 h-12 rounded-full bg-white/30 text-white flex items-center justify-center text-xl shadow inner-shadow">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="text-white">
                            <p class="text-xs uppercase tracking-wide font-semibold opacity-80">Students</p>
                            <p class="text-2xl font-bold">{{ active_students|default:0 }}</p>
                            <p class="text-xs opacity-80">Currently enrolled</p>
                        </div>
                    </div>
                    <div class="rounded-2xl p-5 flex items-center gap-4 border border-transparent shadow" style="background: linear-gradient(135deg, #FDE68A 0%, #F3C7A6 100%);">
                        <div class="w-12 h-12 rounded-full bg-white/50 text-amber-700 flex items-center justify-center text-xl shadow inner-shadow">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="text-amber-900">
                            <p class="text-xs uppercase tracking-wide font-semibold opacity-80">Attendance Reports</p>
                            <p class="text-3xl font-bold">{% if attendance_reports_count %}{{ attendance_reports_count }}{% elif reports_count %}{{ reports_count }}{% elif attendance_count %}{{ attendance_count }}{% else %}—{% endif %}</p>
                            <p class="text-xs opacity-70">View & download attendance files</p>
                        </div>
                    </div>
                    <div class="rounded-2xl p-5 flex items-center gap-4 border border-transparent shadow" style="background: linear-gradient(135deg, #1B2D52 0%, #4D608E 100%);">
                        <div class="w-12 h-12 rounded-full bg-white/30 text-white flex items-center justify-center text-xl shadow inner-shadow">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="text-white">
                            <p class="text-xs uppercase tracking-wide font-semibold opacity-80">Performance</p>
                            <p class="text-2xl font-bold">{{ avg_students_per_course|default:0 }}</p>
                            <p class="text-xs opacity-80">Avg. students per course</p>
                        </div>
                    </div>
                </section>

                <!-- Detailed Columns -->
                <section class="grid grid-cols-1 xl:grid-cols-3 gap-6">
                    <div class="rounded-3xl border border-transparent shadow p-6 space-y-4" style="background: linear-gradient(135deg, #A4DCF2 0%, #FEFAF7 100%);">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold text-gray-900">Upcoming Classes</h3>
                            <span class="text-xs text-gray-500 uppercase tracking-wide">Today & Next</span>
                        </div>
                        <style>
                            @keyframes dotsPulse { 0% { opacity: 0.2 } 50% { opacity: 1 } 100% { opacity: 0.2 } }
                            .dots-anim span { animation: dotsPulse 1.2s infinite; display: inline-block; }
                            .dots-anim span:nth-child(2) { animation-delay: .2s }
                            .dots-anim span:nth-child(3) { animation-delay: .4s }
                        </style>
                        <div class="space-y-2">
                            {% if upcoming_classes %}
                                {% for entry in upcoming_classes|slice:":5" %}
                                <a href="{% url 'dashboard:instructor_my_classes' %}?course={{ entry.id }}" class="flex items-center justify-between p-3 rounded-xl border hover:border-indigo-300 hover:bg-indigo-50/40 transition border-gray-200 no-underline hover:no-underline">
                                    <div class="min-w-0">
                                        {% if entry.section %}
                                        <p class="mb-1">
                                            <span class="px-2 py-0.5 rounded-full font-bold text-[10px] text-white" style="background-color: {{ entry.color|default:'#3C4770' }};">Section {{ entry.section }}</span>
                                        </p>
                                        {% endif %}
                                        <p class="text-sm font-semibold text-gray-900 truncate">{{ entry.code }} • {{ entry.name }}</p>
                                        <p class="text-[11px] text-gray-600 uppercase tracking-wide mt-0.5 truncate">{{ entry.date_label }} • {{ entry.time_label }}</p>
                                    </div>
                                    {% if entry.status == 'live' %}
                                        <span class="ml-3 flex-shrink-0 px-2 py-0.5 rounded-full text-[10px] font-bold bg-green-100 text-green-700 uppercase">Live</span>
                                    {% elif entry.status == 'starting_today' %}
                                        <span class="ml-3 flex-shrink-0 px-2 py-0.5 rounded-full text-[10px] font-bold bg-blue-100 text-blue-700 uppercase">Starting Today</span>
                                    {% elif entry.status == 'tomorrow' %}
                                        <span class="ml-3 flex-shrink-0 px-2 py-0.5 rounded-full text-[10px] font-bold bg-orange-100 text-orange-700 uppercase">Tomorrow</span>
                                    {% elif entry.status == 'upcoming' %}
                                        <span class="ml-3 flex-shrink-0 px-2 py-0.5 rounded-full text-[10px] font-bold bg-yellow-100 text-yellow-700 uppercase">Upcoming</span>
                                    {% elif entry.status == 'soon' %}
                                        <span class="ml-3 flex-shrink-0 px-2 py-0.5 rounded-full text-[10px] font-bold bg-purple-100 text-purple-700 uppercase">Soon</span>
                                    {% elif entry.status == 'ongoing' %}
                                        <span class="ml-3 flex-shrink-0 px-2 py-0.5 rounded-full text-[10px] font-bold bg-indigo-100 text-indigo-700 uppercase">Ongoing</span>
                                    {% else %}
                                        <span class="ml-3 flex-shrink-0 px-2 py-0.5 rounded-full text-[10px] font-bold bg-gray-100 text-gray-600 uppercase">Finished</span>
                                    {% endif %}
                                </a>
                                {% endfor %}
                                {% if upcoming_more_count and upcoming_more_count > 0 %}
                                <div class="text-center text-xs text-gray-500 pt-2">
                                    <span class="dots-anim"><span>•</span><span>•</span><span>•</span></span>
                                </div>
                                {% endif %}
                            {% else %}
                                <p class="text-xs text-gray-500">No active schedules yet.</p>
                            {% endif %}
                        </div>
                    </div>

                    <div class="rounded-3xl border border-transparent shadow p-6 space-y-4" style="background: linear-gradient(135deg, #9DBCE9 0%, #E0BACF 100%);">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold text-gray-900">Recent Courses</h3>
                            <a href="{% url 'dashboard:instructor_courses' %}" class="text-xs text-indigo-600 font-semibold">View all</a>
                        </div>
                        <div class="space-y-4">
                            {% if recent_courses %}
                                {% for course in recent_courses %}
                                <div class="flex items-center justify-between border border-gray-100 rounded-2xl p-4">
                                    <div>
                                        <p class="text-sm font-semibold text-gray-900">{{ course.code|default:'—' }}</p>
                                        <p class="text-xs text-gray-500">{{ course.program.code|default:'' }} {% if course.program.name %}• {{ course.program.name }}{% endif %}</p>
                                    </div>
                                    <span class="px-3 py-1 rounded-full text-xs font-semibold bg-indigo-50 text-indigo-600">{{ course.year_level|ordinal_year|default_if_none:'Year —' }}</span>
                                </div>
                                {% endfor %}
                            {% else %}
                                <p class="text-sm text-gray-500">No recent courses yet.</p>
                            {% endif %}
                        </div>
                    </div>

                    <div class="rounded-3xl border border-transparent shadow-xl p-6 space-y-4" style="background: linear-gradient(135deg, #FFE5C4 0%, #E8C0C2 50%, #C48AA2 100%);">
                        <div class="flex items-center justify-between">
                                <h3 class="text-lg font-bold text-gray-900 flex items-center gap-2">
                                <i class="fas fa-chart-pie text-indigo-600"></i>
                                Attendance Reports
                            </h3>
                            <a href="{% url 'dashboard:instructor_attendance_reports' %}" class="text-xs bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold px-3 py-1.5 rounded-full shadow hover:opacity-90 transition">
                                View Reports
                            </a>
                        </div>
                        <p class="text-sm text-gray-600">View & download attendance files</p>
                        <div class="grid grid-cols-1 gap-3 text-sm">
                            <div class="p-4 rounded-2xl border border-indigo-100 bg-white/70">
                                <p class="font-semibold text-gray-900 mb-1 flex items-center gap-2">
                                    <i class="fas fa-file-excel text-green-600"></i>
                                    Quick Access
                                </p>
                                <p class="text-gray-500">Download attendance reports in Excel format with detailed student statistics.</p>
                            </div>
                            <div class="p-4 rounded-2xl border border-purple-100 bg-white/70">
                                <p class="font-semibold text-gray-900 mb-1 flex items-center gap-2">
                                    <i class="fas fa-filter text-indigo-600"></i>
                                    Advanced Filtering
                                </p>
                                <p class="text-gray-500">Filter by course, section, day, month, or week to get precise attendance data.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Quick Actions -->
                <section class="rounded-3xl border border-transparent shadow p-6" style="background: linear-gradient(135deg, #42B2CB 0%, #9DBCE9 100%);">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4">
                        <div>
                            <h3 class="text-lg font-bold text-gray-900">Quick Actions</h3>
                            <p class="text-sm text-gray-500">Jump into your most common workflows.</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                        <a href="{% url 'dashboard:instructor_courses' %}?open_add_modal=1" class="p-4 rounded-2xl border border-gray-100 hover:border-indigo-200 hover:shadow-lg transition flex items-center gap-4">
                            <span class="w-12 h-12 rounded-2xl bg-indigo-100 text-indigo-600 flex items-center justify-center text-xl"><i class="fas fa-plus"></i></span>
                            <div>
                                <p class="text-sm font-semibold text-gray-900">Add Course</p>
                                <p class="text-xs text-gray-500">Create a new subject</p>
                            </div>
                        </a>
                        <a href="{% url 'dashboard:weekly_timetable' %}" class="p-4 rounded-2xl border border-gray-100 hover:border-indigo-200 hover:shadow-lg transition flex items-center gap-4">
                            <span class="w-12 h-12 rounded-2xl bg-blue-100 text-blue-600 flex items-center justify-center text-xl"><i class="fas fa-calendar-alt"></i></span>
                            <div>
                                <p class="text-sm font-semibold text-gray-900">Weekly Timetable</p>
                                <p class="text-xs text-gray-500">Review and filter schedule</p>
                            </div>
                        </a>
                        <a href="{% url 'dashboard:students' %}" class="p-4 rounded-2xl border border-gray-100 hover:border-indigo-200 hover:shadow-lg transition flex items-center gap-4">
                            <span class="w-12 h-12 rounded-2xl bg-emerald-100 text-emerald-600 flex items-center justify-center text-xl"><i class="fas fa-user-friends"></i></span>
                            <div>
                                <p class="text-sm font-semibold text-gray-900">Manage Students</p>
                                <p class="text-xs text-gray-500">Enrollments & attendance</p>
                            </div>
                        </a>
                        <a href="{% url 'dashboard:instructor_attendance_reports' %}" class="text-left p-4 rounded-2xl border border-gray-100 hover:border-indigo-200 hover:shadow-lg transition flex items-center gap-4 w-full">
                            <span class="w-12 h-12 rounded-2xl bg-emerald-100 text-emerald-600 flex items-center justify-center text-xl"><i class="fas fa-file-excel"></i></span>
                            <div class="flex-1">
                                <p class="text-sm font-semibold text-gray-900">Attendance Reports</p>
                                <p class="text-xs text-gray-500">View & download attendance files</p>
                            </div>
                        </a>
                    </div>
                </section>
            </div>
            {% endblock %}
        </div>
    </main>
</div>
<script>
function toggleSystemCenterDropdown() {
    // Redirect to the Attendance Reports page as the System Center was replaced
    try {
        window.location.href = '{% url "dashboard:instructor_attendance_reports" %}';
    } catch (e) {
        console.log('Redirect to attendance reports failed', e);
    }
}
</script>
{% endblock %}




